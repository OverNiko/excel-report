# Документация программы для работы с данными о посещаемости студентов

## Основные функции

### get_sheet_names(excel_file: str) -> list
Получает список имен всех листов в Excel файле.

**Параметры:**
- `excel_file`: Путь к файлу Excel.

**Возвращает:**
- Список имен листов.

### choose_sheet(excel_file: str) -> str
Позволяет пользователю выбрать лист для работы.

**Параметры:**
- `excel_file`: Путь к файлу Excel.

**Возвращает:**
- Имя выбранного листа.

### parse_date(date: Union[datetime, str, float]) -> Optional[datetime]
Преобразует различные форматы дат в объект datetime.

**Параметры:**
- `date`: Дата в формате datetime, строке или числе.

**Возвращает:**
- Объект datetime или None, если преобразование невозможно.

### save_report(data: pd.DataFrame, file_name: str, group_name: str) -> None
Сохраняет отчет в HTML файл с информацией о группе.

**Параметры:**
- `data`: DataFrame с данными для сохранения.
- `file_name`: Имя файла для сохранения отчета.
- `group_name`: Название группы, к которой относится отчет.

### generate_attendance_report(student_data: pd.DataFrame, dates: list, date: datetime, group_name: str) -> None
Генерирует отчет о посещаемости за указанную дату и предлагает сохранить его.

**Параметры:**
- `student_data`: DataFrame с данными о студентах.
- `dates`: Список доступных дат.
- `date`: Дата для генерации отчета.
- `group_name`: Название группы для включения в отчет.

**Особенности:**
- Сортирует данные по столбцу '№ п/п'.
- Пересоздает столбец '№ п/п' для обеспечения правильного порядка.

### view_all_data(student_data: pd.DataFrame, group_name: str) -> None
Просматривает все данные файла и предлагает сохранить их в отчет.

**Параметры:**
- `student_data`: DataFrame с данными о студентах.
- `group_name`: Название группы для включения в отчет.

### generate_student_report(student_data: pd.DataFrame, dates: list, group_name: str) -> None
Генерирует отчет о посещаемости для выбранного студента.

**Параметры:**
- `student_data`: DataFrame с данными о студентах.
- `dates`: Список дат занятий.
- `group_name`: Название группы.

**Особенности:**
- Выводит отсортированный список студентов.
- Позволяет выбрать студента по номеру.
- Генерирует и отображает отчет о посещаемости для выбранного студента.
- Предлагает сохранить отчет в HTML файл.

### main(excel_file: str, sheet_name: str) -> None
Основная функция программы для обработки данных из Excel и взаимодействия с пользователем.

**Параметры:**
- `excel_file`: Путь к файлу Excel.
- `sheet_name`: Имя листа в файле Excel.

## Использование программы

1. При запуске программа предлагает выбрать лист из Excel файла.
2. Программа автоматически извлекает название группы из выбранного листа.
3. Отображается меню с следующими опциями:
   - Генерация отчета о посещаемости для студента
   - Генерация отчета о посещаемости за день/дату
   - Просмотр всех данных файла
   - Выход
4. При выборе "Генерация отчета о посещаемости для студента":
   - Отображается список всех студентов.
   - Пользователь выбирает студента по номеру.
   - Генерируется и отображается отчет о посещаемости выбранного студента.
   - Предлагается сохранить отчет в HTML файл.
5. При выборе "Генерация отчета о посещаемости за день/дату":
   - Отображается список доступных дат.
   - Пользователь выбирает дату.
   - Генерируется отчет о посещаемости за выбранную дату.
   - Предлагается сохранить отчет в HTML файл.
6. Опция "Просмотр всех данных" показывает все данные из файла и позволяет сохранить их в HTML-отчет.

## Особенности
- Программа работает с файлом Excel по умолчанию, но можно указать другой файл при запуске.
- Пользователь может выбрать конкретный лист из Excel файла для работы.
- Отчеты сохраняются в HTML формате с указанием группы.
- Все отчеты включают информацию о группе.
- Отчеты о посещаемости отдельных студентов и за конкретные даты включают правильно отсортированные данные.

## Запуск программы
```
python app.py [-h] [--file FILE] --sheet_index SHEET_INDEX --action ACTION [--student_index STUDENT_INDEX] [--date_index DATE_INDEX]
```
Где:
- `h` - помощь по командам
- `file` - путь к файлу Excel (по умолчанию "Черненко Александр Александрович.xlsx")
- `sheet_index` - номер листа для работы
- `action` - действие: 1 - отчет по студентам, 2 - отчет по дате, 3 - просмотр всех данных
- `student_index` - номер студента для отчета (только для действия 1)
- `date_index` - номер даты для отчета (только для действия 2)