# Учёт посещаемости студентов

## Описание

Данный проект предназначен для автоматизации учёта посещаемости студентов по данным из Excel-файла. Программа позволяет формировать различные отчёты по посещаемости: по отдельному студенту, по конкретному занятию или по всей группе.  
Результаты сохраняются в формате HTML и/или JSON.

## Основные возможности

- **Отчёт по студенту** — подробная статистика посещаемости выбранного студента.
- **Отчёт по занятию** — информация о посещаемости группы на конкретном занятии.
- **Полный отчёт по группе** — общая статистика по всем студентам и занятиям.
- **Сохранение отчётов** в HTML и/или JSON.
- **Автоматическое исключение будущих дат** — анализируются только прошедшие и текущие занятия.
- **Гибкий выбор формата отчёта** через аргумент командной строки.

## Использование

### Запуск из командной строки

```sh
python app.py --file <путь_к_файлу.xlsx> --sheet_index <номер_листа> --action <действие> [--student_index <номер_студента>] [--date_index <номер_занятия>] [--report_format <формат>]
```

### Аргументы

- `--file` — путь к Excel-файлу (по умолчанию: Черненко Александр Александрович.xlsx)
- `--sheet_index` — номер листа в Excel (по умолчанию: 0)
- `--action` — действие:
    - `1` — отчёт по студенту (требует `--student_index`)
    - `2` — отчёт по занятию (требует `--date_index`)
    - `3` — полный отчёт по группе (по умолчанию)
- `--student_index` — номер студента (начиная с 0, только для действия 1)
- `--date_index` — номер занятия (начиная с 0, только для действия 2)
- `--report_format` — формат отчёта:
    - `1` — только JSON (по умолчанию)
    - `2` — только HTML
    - `3` — и JSON, и HTML

## Примеры

**Отчёт по студенту (HTML):**
```sh
python app.py --action 1 --student_index 0 --report_format 2
```

**Отчёт по занятию (JSON и HTML):**
```sh
python app.py --action 2 --date_index 1 --report_format 3
```

**Полный отчёт по группе (только JSON):**
```sh
python app.py --action 3 --report_format 1
```

## Формат отчётов

- **HTML-отчёты** содержат таблицы с данными и краткую статистику.
- **JSON-отчёты** содержат структурированные данные для дальнейшей обработки.

## Нововведения

- Добавлен аргумент `--report_format` для выбора формата отчёта (JSON, HTML или оба).
- Сохраняются отчёты в формате JSON для всех видов отчётов.
- В отчётах учитываются только прошедшие и текущие занятия (будущие даты автоматически исключаются).
- В каждом отчёте отображается оценка посещаемости (статус и цвет).
- В полном отчёте и отчёте по занятию выводится общая посещаемость в процентах.
- Код структурирован и легко расширяется для новых форматов отчётов.

## Требования

- Python 3.8+
- pandas
- openpyxl

## Запуск

Установите зависимости:
```sh
pip install pandas openpyxl
```

Запустите программу с нужными параметрами.

---

**Пример структуры Excel-файла:**

|       |         |     |          | 2025-02-03 | 2025-02-10 | ... |
| № п/п | Фамилия | Имя | Отчество |     1      |     2      | ... |
|-------|---------|-----|----------|------------|------------|-----|
| 1     | Иванов  | Иван| Иванович |     1      |     0      | ... |
| 2     | Петров  | Петр| Петрович |     1      |     1      | ... |

---
